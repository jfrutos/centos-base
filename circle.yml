machine:
  services:
    - docker

deployment:
  dockehub:
    branch: master
    commands:
      - DOCKER_HUB_TRIGGER
test:
  override:
    - docker run -it jfrutos/centos-base echo "Hello World"
  dependencies:
    cache_directories:
      - "~/centos-base"
    override:
      - docker info
      - if [[ -e ~/centos-base/image.tar ]]; then docker load --input ~/centos-base/image.tar; fi
      - docker build -t jfrutos/centos-base .
      - mkdir -p ~/centos-base; docker save --output ~/centos-base/image.tar jfrutos/centos-base
